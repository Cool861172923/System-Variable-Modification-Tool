# Windows PATH 环境变量管理工具包

## 📁 工具文件说明

### 🔧 主要工具
- **`system_path_simple.bat`** - 系统PATH专用管理工具（**推荐使用**）
  - 强制管理员权限检查
  - 专门修改系统环境变量
  - 简洁的菜单界面
  - 详细的操作指导
  - 不会闪退，稳定可靠
  - 完全解决权限问题

### 🛠️ 专用工具
- **`add_to_path.bat`** - 专门用于添加当前目录到PATH
- **`remove_from_path.bat`** - 专门用于从PATH移除当前目录
- **`fix_system_path.bat`** - 修复被损坏的系统PATH（需管理员权限）

### 📖 文档
- **`README.md`** - 本文档
- **`path_manager_demo.md`** - 详细使用说明

## 🚀 快速开始

### 🔥 主要方式：使用系统PATH专用工具（推荐）
如果你遇到"只能添加到用户环境变量"的问题：

1. **右键点击** `system_path_simple.bat`
2. **选择**"以管理员身份运行"
3. **点击**"Yes"在UAC提示中
4. **使用菜单** 进行操作：
   - `1` = 添加路径到系统PATH
   - `2` = 移除路径从系统PATH
   - `3` = 查看当前系统PATH
   - `Q` = 退出

### 方式二：使用专用工具
- 进入要添加的目录，双击 `add_to_path.bat`
- 进入要删除的目录，双击 `remove_from_path.bat`

## ⚠️ 重要提示

### 权限要求
- **用户环境变量**：无需特殊权限
- **系统环境变量**：需要"以管理员身份运行"

### 变更生效
修改后需要：
- 重启命令提示符/PowerShell，或
- 重新登录Windows用户，或
- 运行 `refreshenv` 命令（如果有Chocolatey）

### 安全特性
- ✅ 路径存在性验证
- ✅ 重复添加检查
- ✅ 管理员权限检测
- ✅ 操作确认机制
- ✅ 调试输出保护
- ✅ ANSI编码兼容

## 🔍 验证结果
在新的命令提示符中运行：
```cmd
echo %PATH%
```

## 🆘 故障恢复
如果系统PATH被意外损坏：
1. 以管理员身份运行 `fix_system_path.bat`
2. 按提示确认恢复操作
3. 重启计算机

---
*工具版本：v2.0 | 编码：ANSI | 兼容性：Windows 7/8/10/11*

## ⚠️ 编码问题解决

### 问题描述
如果你看到中文显示乱码（如："鞍茄芸"），这是因为批处理文件编码问题。

### 解决方案
1. **优先使用** [`system_path_simple.bat`](file://h:\Tool\system_path_simple.bat) - 稳定可靠，不会闪退
2. 在不同的命令行环境中测试（CMD vs PowerShell）